<!DOCTYPE html>
<html>
<head>
	<title>Monna MyStory 4.0 -- HaxiDenti</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<style type="text/css">
		#buttons button {
			display: block;
			width: 99%;
			border-radius: 0px 32px;
			color: white;
			background-color: rgba(0, 0, 0, .5);
			transition: 200ms;
			font-size: 24px;
			margin-left: 20%;
			width: 60%;
		}

		#buttons button:hover {
			background-color: white;
			color: black;
			border-radius: 32px 0px;
			margin-left: 0%;
			width: 100%;
		}

		#app {
			position: absolute;
			width: 80%;
			left: 10%;
		}

		#text {
			font-size: 24px;
			border-radius: 32px;
			padding: 32px;
			border: none;
			background-color: rgba(0, 0, 0, .4);
			color: white;
			transition: 300ms;
			overflow: auto;
		}

		#body {
			transition: 300ms;
		}

		#images img {
			transition: 1000ms;
		}
	</style>
</head>
<body>

	<div id=images></div>
	<div id=app>
		<div id=text></div> 
		<div id=buttons></div>
	</div>

	<script type="text/javascript">
		var chapters = [];
		function _chapter(name, sceneName) {
			chapters.push(
				{name: name, scene: sceneName}
			);
		}

		// Save and load the game
		var mem = {}
		function save(slot) {
			memjson = JSON.stringify(mem);
			localStorage.setItem('slot_' + slot, memjson);
		}

		function load(slot) {
			memjson = localStorage.getItem('slot_' + slot);
			mem = JSON.parse(memjson);
		}

		// Timers
		window.addEventListener("load", function() {
			setInterval(function() {
				var height = window.innerHeight;
				var appHeight = document.getElementById("app").offsetHeight;
				var newTopPos = ((height / 2) - appHeight/2);
				if (newTopPos < 0) newTopPos = 0;
				document.getElementById("app").style.top = newTopPos + "px";
				document.body.style['background-size'] = "100% " + height + "px";
			}, 100);

			// Animation for added images
			var an = 0;
			setInterval(function() {
				var images = document.getElementById("images").children;
				function move(ypos) {
					for (var i = 0; i < images.length; i++) {
						var y = parseInt(images[i].style.bottom);
						y += ypos;
						images[i].style.bottom = y + "px";
					}
				}

				if (an == 0) {
					move(10); an = 1;
				} else {
					move(-10) ; an = 0;
				}
			}, 1000);
		})

		function button(caption, oncl) {
			var b = document.createElement("button");
			b.innerHTML = caption;
			b.onclick = oncl;
			var div = document.getElementById("buttons");
			div.appendChild(b);
		}

		function clear() {
			document.getElementById("text"   ).innerHTML = "";
			document.getElementById("buttons").innerHTML = "";
		}

		function print(txt) {
			printnb(txt + "<br>");
		}

		function printnb(txt) {
			var div = document.getElementById("text");
			div.innerHTML += txt;
		}

		function bgImg(src) {
			var height = window.innerHeight;
			document.body.style['background-image'] = "url("+src+")";
			document.body.style['background-repeat'] = "no-repeat";
			document.body.style['background-attachment'] = "fixed";
			document.body.style['transition'] = "200ms";
		}

		var sound = new Audio();
		function snd(src) {
			if (src == undefined
				|| src == ""
				|| src == "."
			) {
				sound.currentTime = 0;
				sound.pause();
			}
			sound.src = src;
			sound.currentTime = 0;
			sound.play();
		}


		var music = new Audio();
		music.volume = 0.4;
		music.loop = true;
		function mus(src) {
			if (src == undefined
				|| src == ""
				|| src == "."
			) {
				music.currentTime = 0;
				music.pause();
			}
			music.src = src;
			music.currentTime = 0;
			music.play();
		}

		function _next(name, del, auto) {
			setTimeout(function() {
				var ev  = name + "();";
				var fun = function() { eval(ev); };
				if (!auto) {
					button("Next &gt;&gt;", fun);
				} else {
					fun();
				}
			}, del);
		}

		function img_set(src, x, y, w, h) {
			var div = document.getElementById("images");
			var img = document.createElement("img");
			img.src = src;
			img.style.position = "absolute";
			img.style.left     = x + "%";
			img.style.top      = y + "%";
			img.style.width    = w + "%";
			img.style.height   = h + "%";
			div.appendChild(img);
		}

		function img_side(src, left) {
			var div = document.getElementById("images");
			var img = document.createElement("img");
			img.src = src;
			img.style.position = "absolute";
			img.style.bottom = "10px";
			img.style.width = "30%";
			if (left) {
				img.style.left = "0px";
			} else {
				img.style.right = "0px";
				img.style.transform = "scaleX(-1)";
			}
			div.appendChild(img);
		}

		function img_clear() {
			var div = document.getElementById("images");
			div.innerHTML = "";
		}

		function _text_hide(flag) {
			var div = document.getElementById("text");
			if (flag) {
				div.style.opacity = 0;
			} else {
				div.style.opacity = 1;
			}
		}

		function _chapterButtons() {
			chapters.forEach(function(chapter, i, arr) {


				button((i + 1) + ". " + chapter.name, function() {4
					eval(chapter.scene + "();");
				});
			})
		}

		function _chapterButton(caption, chName) {
			function findChapter(name) {
				var found;
				chapters.forEach(function (e) { 
					if (e.name == name) {
						found = e;
						return; // break
					}
				});
				return found;
			}

			var chapter = findChapter(chName);
			if (chapter) {
				button(caption, function() { eval(chapter.scene + "();"); });
			}
		}

function scene_0() {
clear();
var current = "scene_0";
var reload = window.scene_0;
_next('scene_1', 0, false);
bgImg('res/logo.jpg');
print('Monna MyStory * HaxiDenti Ihor-fox [UA] 2018');
print('V4.4');
print('Choose your chapter');
_chapterButtons();
}

_chapter('Начало', 'scene_1');
function scene_1() {
clear();
var current = "scene_1";
var reload = window.scene_1;
_next('scene_2', 1400, false);
mus('res/01.mp3');
bgImg('res/01.jpg');
print('Каждый имеет мечту,');
}

function scene_2() {
clear();
var current = "scene_2";
var reload = window.scene_2;
_next('scene_3', 1400, false);
print('кто-то хочет покорить небеса,');
}

function scene_3() {
clear();
var current = "scene_3";
var reload = window.scene_3;
_next('scene_4', 1400, false);
print('кто-то хочет найти друга,');
}

function scene_4() {
clear();
var current = "scene_4";
var reload = window.scene_4;
_next('scene_5', 1400, false);
print('кто-то достичь невероятного в жизни,');
}

function scene_5() {
clear();
var current = "scene_5";
var reload = window.scene_5;
_next('scene_6', 1400, false);
print('а я хочу лишь быть для вас тем, кого привыкли видеть и любить');
}

function scene_6() {
clear();
var current = "scene_6";
var reload = window.scene_6;
_next('scene_7', 1400, false);
bgImg('res/02.jpg');
print('Моя жизнь совсем не сладкая.');
}

function scene_7() {
clear();
var current = "scene_7";
var reload = window.scene_7;
_next('scene_8', 1400, false);
print('Никто мне особо не помогал в моих успехах.');
}

function scene_8() {
clear();
var current = "scene_8";
var reload = window.scene_8;
_next('scene_9', 1400, false);
print('Я шел сам к своей мечте.');
}

function scene_9() {
clear();
var current = "scene_9";
var reload = window.scene_9;
_next('scene_10', 1400, false);
bgImg('res/logo.jpg');
print('Мне было неочем мечтать.');
}

function scene_10() {
clear();
var current = "scene_10";
var reload = window.scene_10;
_next('scene_11', 1400, false);
print('Я оставался лишь ребенком,');
}

function scene_11() {
clear();
var current = "scene_11";
var reload = window.scene_11;
_next('scene_12', 1400, false);
print('лишь тем, кого называли никем.');
}

function scene_12() {
clear();
var current = "scene_12";
var reload = window.scene_12;
_next('scene_13', 1400, false);
bgImg('res/02.jpg');
print('Но со временем все меняется.');
}

function scene_13() {
clear();
var current = "scene_13";
var reload = window.scene_13;
_next('scene_14', 1400, false);
print('Я создал то, что может помочь многим.');
}

function scene_14() {
clear();
var current = "scene_14";
var reload = window.scene_14;
_next('scene_15', 1400, false);
print('Я буду двигаться к мечте, меняя судьбы других в лучшую сторону.');
}

function scene_15() {
clear();
var current = "scene_15";
var reload = window.scene_15;
_next('scene_16', 1400, false);
print('Я тот, кто возможно изменит и твою...');
}

function scene_16() {
clear();
var current = "scene_16";
var reload = window.scene_16;
_next('scene_17', 1400, false);
print('Спасибо тебе, что все время ты со мной.');
}

function scene_17() {
clear();
var current = "scene_17";
var reload = window.scene_17;
_next('scene_18', 1400, false);
print('Мне жаль, если что-то мешает мне с тобой нормально общаться. Но ты хороший друг.');
}

function scene_18() {
clear();
var current = "scene_18";
var reload = window.scene_18;
_next('scene_19', 1400, false);
print('Что бы со мной не случилось,');
}

function scene_19() {
clear();
var current = "scene_19";
var reload = window.scene_19;
_next('scene_20', 2000, true);
print('знай,');
}

function scene_20() {
clear();
var current = "scene_20";
var reload = window.scene_20;
_next('scene_21', 1300, false);
print('Ты всегда будешь для меня лучшим другом.');
}

function scene_21() {
clear();
var current = "scene_21";
var reload = window.scene_21;
_next('scene_22', 1300, false);
bgImg('res/logo.jpg');
print('Не поминай лихом');
}

function scene_22() {
clear();
var current = "scene_22";
var reload = window.scene_22;
print('Прощай!');
}



scene_0();

	</script>

</body>
</html>